<!-- <link rel="stylesheet" href="/css/home.css"> -->
<div id="main-display">
    <h2>
        Welcome to CoDEial!!
    </h2>
    <div>
        <p>
            CoDEial is a platform created with an idea to provide developers and programmers a
            place to meet..
        </p>
    </div>
    <section id="feed-posts">
        <h3>Your Feed and Posts:</h3>
        <% if (locals.user) { %>
            <form action="/posts/create" id="new-post-form" method="POST">
                <h4>
                    Hey, <%- user.name %>, what's on your mind??
                </h4>
                <textarea name="content" id="" cols="30" rows="5" placeholder="type here...." required>

                </textarea>
                <br>
                <input type="submit" value="Post">
            </form>
        <% } %>
        <div id="post-list-container">
            <ul>
                <% for (post of posts) { %>
                    <li>
                        <p>
                            <%= post.user.name%> says :
                        </p>
                        <p>
                            <%= post.content %>
                            <% if (locals.user && locals.user.id==post.user.id) {%>
                                <a href="/posts/destroy/<%= post.id %>">
                                    <i class="fa-solid fa-trash"></i>
                                </a>
                            <% } %>
                        </p>
                        <div class="post-comments">
                            <% if(locals.user){ %>
                                <form action="/comments/create" method="POST">
                                    <input type="text" name="content" placeholder="Comment Here..." required>
                                    <!-- IMP NOTE:The below input field takes in the post id to store in DB and is hidden -->
                                    <input type="hidden" name="post" value="<%= post._id%>">
                                    <input type="submit" value="Add Comment">
                                </form>
                            <% } %>

                            <div class="post-comments-list">
                                <ul id="post-comments-<%= post._id %>">
                                    <% for(comment of post.comments) { %>
                                        <p>
                                            <%= comment.user.name %> commented:
                                        </p>
                                        <p>
                                            <%= comment.content %>
                                        </p>

                                    <% } %>

                                </ul>
                            </div>
                        </div>
                        
                    </li>

                <% } %>

            </ul>
            
        </div>

    </section>
</div>